<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Deb's Trivia Game</title>

  <!-- Added link to the jQuery Library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

  <!-- Added a link to Bootstrap-->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">

  <!-- Added a link to our external stylesheet-->
  <link rel="stylesheet" href="assets/css/style.css">

</head>

<body>


  <!-- Overall Bootstrap Grid -->
  <div class="container">

    <!-- Jumbotron with Title -->
    <!--div class="jumbotron">
      <h1 class="text-center">
        <span class="head">Travel Trivia</span>
      </h1>

      <hr>
      <div id="musicControls" class="text-center">
        <button class="btn btn-warning btn-xs theme-button">
          <span class="fa fa-music"></span> Play Theme!</button>
        <button class="btn btn-dark btn-xs pause-button">
          <span class="fa fa-pause"></span> Pause Song</button>
      </div-->
    <div>
      <h1 class="text-center">
        <span class="head">World Trivia</span>
      </h1>
    </div>


    <div class="row text-center">
      <div class="col-sm-12">
        <div id="timer"> </div>
      </div>
    </div>

    <div class="row text-center">
      <div class="col-sm-12">
        <div id="question"> </div>
      </div>
    </div>

    <div class="row">
      <div class="col-sm-12">
        <div id="optionsBtn"> </div>
      </div>
    </div>

    <div class="row">
      <div class="col-sm-12">
        <div id="response"> </div>
      </div>
    </div>

    <div class="row">
      <div class="col-sm-5">
        <div class="winloss">
          <h5 id="wins-text"></h5>
          <h5 id="losses-text"></h5>
          <h5 id="unanswered-text"></h5>
        </div>
      </div>
    </div>
  </div>

  <!--div class="row">
      <div class="col-lg-5">
        <div class="row">
          <div class="col-lg-2">
            <button id="button-1" class="btn crystal" value="0">
              <img src="assets/images/1-crystal.png" /></button>
          </div>
          <div class="col-lg-2">
            <button id="button-2" class="btn crystal" value="0">
              <img src="assets/images/2-crystal.png" />
            </button>
          </div>
          <div class="col-lg-2">
            <button id="button-3" class="btn crystal" value="1">
              <img src="assets/images/3-crystal.png" /></button>
          </div>
          <div class="col-lg-2">
            <button id="button-4" class="btn crystal" value="1">
              <img src="assets/images/4-crystal.png" />
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-lg-3">
        <h4>Your total score is</h4>
      </div>
    </div>
    <div class="row">
      <div class="col-lg-3">
        <h5 id="user-score"></h5>
      </div>
    </div-->
  <script type="text/javascript">
    var questions = [
      {
        "question": "What day is it?",
        "options": ["Monday", "Tuesday", "Wednesday", "Thursday"],
        "answer": 3,
        "url": "assets/images/question1.png"
      },
      {
        "question": "What day was yesterday?",
        "options": ["Monday", "Tuesday", "Wednesday", "Thursday"],
        "answer": 2,
        "url": "assets/images/question2.png"
      }
    ];
    var correct = 0,
      wrong = 0,
      unanswered = 0,
      currentQuestion = 0;

    /*console.log(questions[0].question);
    console.log(questions[0].options[questions[0].answer]);
    console.log(questions[0].url);

    console.log(questions[1].question);
    console.log(questions[1].options[questions[1].answer]);
    console.log(questions[1].url);*/

    //  Set our number counter to 100.
    var timelimit = 10;
    var pausetime = 5;

    //  Variable that will hold our interval ID when we execute
    //  the "run" function
    var intervalId;
    var questionIndex = 0;


    //  The run function sets an interval
    //  that runs the decrement function once a second.
    //  *****BUG FIX******** 
    //  Clearing the intervalId prior to setting our new intervalId will not allow multiple instances.
    function startTimer() {
      timelimit = 10;
      clearInterval(intervalId);
      intervalId = setInterval(decrement, 1000);
    }

    //  The decrement function.
    function decrement() {
      //  Decrease number by one.
      timelimit--;
      //  Show the number in the #show-number tag.
      $("#timer").html("<h2>" + "Time Remaining: " + timelimit + "</h2>");
      // $("#timer").text("Time Remaining: " + timelimit);


      //  Once number hits zero...
      if (timelimit === 0) {

        //  ...run the stop function.
        stopTimer();

        //  Alert the user that time is up.
        $("#timer").html("<h2>" + "Times Up!" + "</h2>");
      }
    }

    function displayResponse(currentQuestion, correct) {
      var response = $("<div>");
      if (correct = "yes") {
        response.text("Way to go!");
      }
      else {
        response.text("Ahhhhh, keep trying!");
      }

      /* startBtn.attr("data-letter", letters[i]);
      startBtn.text("Start");*/
      $("#response").append(response);

    }

    //  The stop function
    function stopTimer() {

      //  Clears our intervalId
      //  We just pass the name of the interval
      //  to the clearInterval function.
      clearInterval(intervalId);
    }

    //  display the start button

    function initializeGame() {

      var startBtn = $("<button>");
      startBtn.addClass("start-button");
      /* startBtn.attr("data-letter", letters[i]);*/
      startBtn.text("Start");
      $("#optionsBtn").append(startBtn);
    }


    function checkAnswer(answerNum, selected) {
console.log("answernum "+answerNum+" seected "+selected);
      stopTimer()
      $("#response").empty();
      var response = $("<img>");
      if (questions[answerNum].answer === selected) {
        displayResponse(answerNum, "yes");
      }
      else {
        displayResponse(answerNum, "no");
      }
      /*  startBtn.addClass("start-button");
       startBtn.attr("data-letter", letters[i]);
      startBtn.text("Start");
      $("#optionsBtn").append(startBtn);*/
    }

    function showQuestion(currentQuestion) {
      /*$("#question").empty();*/
      $("#question").text(questions[currentQuestion].question);
      $("#optionsBtn").empty();
      for (var i = 0; i < questions[currentQuestion].options.length; i++) {

        //create html programmatically
        var optionBtn = $("<button>");
        optionBtn.addClass("option1");
        optionBtn.attr("optionnum", i);
       /* if (i === 0) {
          $("#optionsBtn").text(optionBtn);
        }
        else*/ {
          optionBtn.text(questions[currentQuestion].options[i]);
          $("#optionsBtn").append(optionBtn);
        }
      }
    }

    //processing code
    $(document).ready(function () {

      initializeGame();


      $(".start-button").on("click", function () {

        //this will display the question and choices
        /* for (var i = 0; i < questions.length; i++) {*/
        showQuestion(questionIndex);
        //startTimer();
        /*questionIndex++;*/
      });

      //when answer selected, see if it is correct and display picture/message
      $(".option1").on("click", function () {
        console.log("option-click "+questionIndex);
        checkAnswer(questionIndex, parseInt($(this).attr("optionsnum")));
        questionIndex++;
        showQuestion(questionIndex);
        startTimer();

        /*userScore += parseInt($(this).attr("optionsNum"));
        $("#user-score").text(userScore);
        checkResult(userScore, randomNumber);*/
      });


    });
  </script>

  <!--script src="assets/javascript/app.js"></script-->
  </div>
</body>

</html>